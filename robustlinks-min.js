var RLuriPatternsToExclude=["https?://dx.doi.org*","https?://doi.org*"],RLhasHTTPRegexp=/^https?:/,RLhasColonRegexp=/:/;function RLIsURL(e){return Boolean(e)&&(RLhasHTTPRegexp.test(e)||!RLhasColonRegexp.test(e))}Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=this.length;t--;)if(this[t]===e)return t;return-1});var RL_ID=function(){return"RL_"+Math.random().toString(36).substr(2,9)};function RL_appendHiddenLink(e,t,n){var r=document.createElement("li"),a=document.createElement("div"),i=document.createElement("a");i.setAttribute("class","robustLinks RLItem"),i.href=n,i.innerHTML=t,a.appendChild(i),r.appendChild(a),e.appendChild(r)}function RLAddZero(e){return e<10&&(e="0"+e),e}function RLFormatDate(e){var t=new Date(e);if(isNaN(t)&&(t=new Date(e.replace(/ /g,"T")),isNaN(t)))return"Invalid date";var n="";return n+=t.getUTCFullYear(),n+=RLAddZero(t.getUTCMonth()+1),n+=RLAddZero(t.getUTCDate()),n+=RLAddZero(t.getUTCHours()),n+=RLAddZero(t.getUTCMinutes()),n+=RLAddZero(t.getUTCSeconds())}function RLPrintDate(e){var t=RLFormatDate(e),n=t.substr(0,4)+"-"+t.substr(4,2)+"-"+t.substr(6,2);return"000000"!=t.substr(8,6)&&(n+=" "+t.substr(8,2)+":"+t.substr(10,2)+":"+t.substr(12,2)),n}var RLLastOpen,RLDomainRegExp=new RegExp("(?:https?://)?(?:www\\.)?((?:[A-Za-z0-9_\\.])+)(?:/.*)?","i");function RLPrintDomainName(e){var t=e.match(RLDomainRegExp);if(t&&t.length>1){var n=t[1];return n.length>15?n.substr(0,15)+"...":n}return"unknown archive"}function RLCloseLastOpen(){RLLastOpen&&(RLLastOpen.setAttribute("aria-hidden","true"),RLLastOpen=null)}function RLGetAttribute(e,t){try{return e.getAttribute(t).trim()}catch(e){return""}}function robustify_links_on_page(){console.log("callable robust links started...");for(var e=document.getElementsByTagName("span"),t=e.length-1;t>=0;t--)ariaLabel=RLGetAttribute(e[t],"aria-label"),role=RLGetAttribute(e[t],"role"),"RLElement"==ariaLabel&&(role="navigation")&&e[t].parentNode.removeChild(e[t]);var n=document.getElementsByTagName("a");for(t=0;t<n.length;t++){var r=RLGetAttribute(n[t],"href");if(0==!r.search("http")){var a=window.location,i=a.protocol+"//"+a.host;0==!r.search("/|../|./")&&(i+="/"),r=i+r}var o=RLGetAttribute(n[t],"data-originalurl"),s=Boolean(o);s||(o=r);var u=RLGetAttribute(n[t],"data-versionurl"),d=Boolean(u);!d&&s&&(u=r);var l=RLGetAttribute(n[t],"data-versiondate"),L=Boolean(l),p=new RegExp("(?:"+RLuriPatternsToExclude.join(")|(?:")+")");if(n[t].href.length>0&&(" "+n[t].className+" ").indexOf(" robustLinks ")<0&&(s||d||L)&&!p.test(r)&&RLIsURL(r)){var c=RL_ID(),R=document.createElement("span");R.setAttribute("role","navigation"),R.setAttribute("aria-label","RLElement");var m=document.createElement("ul"),b=document.createElement("li");b.setAttribute("aria-label","RLOuter");var h=document.createElement("a");h.href="",h.setAttribute("aria-haspopup","true"),h.setAttribute("class","robustLinks dropDownButton RLArrow"),h.setAttribute("aria-controls",c);var g=document.createElement("div");g.setAttribute("class","robustLinks dropDownButton RLIcon");var f=document.createElement("ul");if(f.setAttribute("class","RLMenu"),f.id=c,f.setAttribute("aria-hidden","true"),document.createElement("li").setAttribute("class","RLTitle"),o&&RL_appendHiddenLink(f,"Current version of page",o),u&&RL_appendHiddenLink(f,"Version archived on "+RLPrintDate(l),u),L){var v="http://timetravel.mementoweb.org/memento/"+RLFormatDate(l)+"/"+o;RL_appendHiddenLink(f,"Version archived near "+RLPrintDate(l),v)}RL_appendHiddenLink(f,'<span style="text-decoration: underline; color:#0000ff"><img src="https://robustlinks.mementoweb.org/images/robustlinks-16px.png">Robustify Your Links!</span>',"http://robustlinks.mementoweb.org/"),b.appendChild(h),b.appendChild(f),m.appendChild(b),R.appendChild(m),h.parentNode.insertBefore(g,h),h.onclick=function(e){var t=document.getElementById(this.getAttribute("aria-controls")),n="true"==t.getAttribute("aria-hidden");return RLCloseLastOpen(),n?(t.setAttribute("aria-hidden","false"),RLLastOpen=t):(t.setAttribute("aria-hidden","true"),RLLastOpen=null),e.stopPropagation(),!1},n[t].parentNode.insertBefore(R,n[t].nextSibling)}}return document.onclick=RLCloseLastOpen,!0}document.addEventListener("DOMContentLoaded",function(){robustify_links_on_page()},!1);
